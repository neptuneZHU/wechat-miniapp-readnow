<!-- é¡¶éƒ¨å¤´åƒ + å¼•è¨€ -->
<view class="banner">
  <image class="avatar" src="{{woolfImgUrl}}"></image>
  <text class="quote">"ä¸€é—´è‡ªå·±çš„æˆ¿é—´"</text>
</view>

<!-- æ—¥å†åŒºåŸŸ -->
<view class="calendar">
  <view class="weekdays">
    <view class="weekday">æ—¥</view>
    <view class="weekday">ä¸€</view>
    <view class="weekday">äºŒ</view>
    <view class="weekday">ä¸‰</view>
    <view class="weekday">å››</view>
    <view class="weekday">äº”</view>
    <view class="weekday">å…­</view>
  </view>
  <view class="days">
    <block wx:for="{{days}}" wx:key="index">
      <view class="day {{item.empty ? 'empty' : ''}} {{item.marked ? 'marked' : ''}}" bindtap="markDay" data-index="{{index}}">
        <text>{{item.day}}</text>
        <text wx:if="{{item.read}}" class="reading-indicator">ğŸ“š</text>
        <text wx:if="{{item.leave}}" class="leave-indicator">ğŸ–ï¸</text>
      </view>
    </block>
  </view>
</view>

<!-- æµ®åŠ¨æŒ‰é’® + å±•å¼€èœå• -->
<view class="fab" bindtap="toggleMenu">
  <text class="plus">+</text>
</view>
<view wx:if="{{menuOpen}}" class="fab-menu">
  <view bindtap="gotoCheckin">ğŸ“… æ‰“å¡</view>
  <view bindtap="gotoNote">ğŸ“ ç¬”è®°</view>
  <view bindtap="gotoLeave">ğŸ™‹ è¯·å‡</view>
</view>

<!-- æ‰“å¡å¼¹çª— -->
<view class="popup-mask" wx:if="{{showCheckinPopup}}" bindtap="closeCheckinPopup"></view>
<view class="checkin-popup" wx:if="{{showCheckinPopup}}">
  <view class="title">{{isLeave ? 'è¯·å‡ç”³è¯·' : 'æ‰“å¡'}}</view>
  <view class="date-selector">
    <text bindtap="selectPrevDay" class="arrow">â—€</text>
    <text class="date">{{selectedDate}}</text>
    <text bindtap="selectNextDay" class="arrow">â–¶</text>
  </view>
  <view class="content">
    <block wx:if="{{!isLeave}}">
      <view class="checkin-form">
        <view class="image-upload">
          <view class="upload-preview" wx:if="{{checkinImage}}">
            <image src="{{checkinImage}}" mode="aspectFill" bindtap="previewImage"></image>
            <view class="delete-btn" bindtap="deleteImage">Ã—</view>
          </view>
          <view class="upload-buttons" wx:else>
            <view class="upload-btn" bindtap="chooseImage">
              <text class="icon">ğŸ“·</text>
              <text>æ‹ç…§</text>
            </view>
            <view class="upload-btn" bindtap="chooseImageFromAlbum">
              <text class="icon">ğŸ–¼ï¸</text>
              <text>ç›¸å†Œ</text>
            </view>
          </view>
        </view>
        <view class="checkin-info" wx:if="{{continuousDays > 0}}">
          è¿ç»­æ‰“å¡ {{continuousDays}} å¤©
        </view>
      </view>
    </block>
    <block wx:else>
      <view class="leave-form">
        <view class="form-item">
          <text class="label">å¼€å§‹æ—¥æœŸï¼š</text>
          <picker mode="date" value="{{leaveStartDate}}" start="{{today}}" bindchange="onStartDateChange">
            <view class="picker">{{leaveStartDate}}</view>
          </picker>
        </view>
        <view class="form-item">
          <text class="label">ç»“æŸæ—¥æœŸï¼š</text>
          <picker mode="date" value="{{leaveEndDate}}" start="{{leaveStartDate}}" bindchange="onEndDateChange">
            <view class="picker">{{leaveEndDate}}</view>
          </picker>
        </view>
        <view class="form-item">
          <text class="label">è¯·å‡åŸå› ï¼š</text>
          <textarea placeholder="è¯·è¾“å…¥è¯·å‡åŸå› " bindinput="onLeaveReasonInput" value="{{leaveReason}}" class="reason-input"></textarea>
        </view>
      </view>
    </block>
  </view>
  <view class="buttons">
    <view class="btn btn-secondary" bindtap="closeCheckinPopup">å–æ¶ˆ</view>
    <view class="btn btn-primary" bindtap="confirmCheckin">{{isLeave ? 'æäº¤' : 'ç¡®è®¤'}}</view>
  </view>
</view>
